<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="utf-8"/>
  <meta name="viewport" content="width=device-width,initial-scale=1"/>
  <title>Mis diseños · Ludus Stamps</title>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css"/>
  <link rel="stylesheet" href="/styles.css"/>
  <style>
    .user-wrap{max-width:1100px;margin:2rem auto;padding:1rem}
    .toolbar{display:flex;align-items:center;justify-content:space-between;margin-bottom:.75rem;gap:.75rem}
    .table-wrap{overflow-x:auto}
    table{width:100%;border-collapse:separate;border-spacing:0 .5rem}
    td,th{padding:.6rem .8rem;background:#fff;vertical-align:top}
    th{color:#334155;text-align:left}
    td:first-child,th:first-child{border-top-left-radius:10px;border-bottom-left-radius:10px}
    td:last-child,th:last-child{border-top-right-radius:10px;border-bottom-right-radius:10px}
    .thumb{width:60px;height:60px;border-radius:10px;object-fit:cover;background:#f1f5f9}
    .muted-sm{color:#64748b;font-size:.85rem}
    .right{text-align:right}
    .actions{display:flex;gap:.5rem;justify-content:flex-end;flex-wrap:wrap}
    dialog form{min-width:min(540px,95vw)}
    dialog .grid{display:grid;gap:.75rem}
    dialog label{font-size:.85rem;color:#475569}
    dialog .input, dialog textarea, dialog select{margin-top:.35rem}
    #msgEdit{min-height:1.2em}
    #msgEdit.error{color:#b91c1c}
    #msgEdit.ok{color:#0f766e}
    .status-pill{
      display:inline-flex;align-items:center;gap:.35rem;
      padding:.25rem .65rem;border-radius:999px;font-size:.78rem;font-weight:600
    }
    .status-pill.published{background:#dcfce7;color:#166534}
    .status-pill.pending{background:#fef3c7;color:#92400e}
    .status-pill.rejected{background:#fee2e2;color:#991b1b}
    .preview-frame{margin-top:.5rem;background:#f1f5f9;border:1px solid #e2e8f0;border-radius:10px;padding:.5rem;display:none;justify-content:center}
    .preview-frame img{max-width:100%;border-radius:8px;display:block}
  </style>
</head>
<body>
<header class="site-header">
  <div class="container nav">
    <a class="brand" href="/"><img src="/img/logo.png" alt="Logo"/></a>
    <nav class="menu">
      <a href="/"><i class="fa-solid fa-house"></i> Inicio</a>
      <a href="/designs.html"><i class="fa-solid fa-palette"></i> Diseños</a>
    </nav>
  </div>
</header>

<main class="user-wrap">
  <h1>Mis diseños</h1>

  <nav class="admin-subnav">
    <a href="/user-designs.html" class="tab"><i class="fa-solid fa-rectangle-list"></i> Mis diseños</a>
    <a href="/upload.html" class="tab"><i class="fa-solid fa-cloud-arrow-up"></i> Subir diseño</a>
  </nav>

  <div class="toolbar">
    <p class="muted-sm">Gestioná tus diseños subidos. Solo el equipo de Ludus puede aprobar la publicación.</p>
    <span id="resultInfo" class="muted-sm"></span>
  </div>

  <div class="table-wrap">
    <table>
      <thead>
        <tr>
          <th>Imagen</th>
          <th>Datos</th>
          <th>Likes</th>
          <th>Estado</th>
          <th class="right">Acciones</th>
        </tr>
      </thead>
      <tbody id="rows">
        <tr><td colspan="5">Cargando…</td></tr>
      </tbody>
    </table>
  </div>
</main>

<dialog id="modalEdit">
  <form id="formEdit" method="dialog" class="card" style="padding:1rem">
    <h3>Editar diseño</h3>
    <input type="hidden" name="id"/>
    <p id="statusNote" class="muted-sm" style="margin-bottom:.75rem"></p>
    <div class="grid">
      <label>Título
        <input class="input" type="text" name="title" required minlength="3" maxlength="120"/>
      </label>
      <label>Categoría
        <select class="input" name="category_id" id="selCategory"></select>
      </label>
      <label>Imagen
        <input class="input" type="file" name="image" accept="image/png,image/jpeg,image/webp" />
      </label>
      <label>Descripción
        <textarea class="input" name="description" rows="4" placeholder="Opcional"></textarea>
      </label>
    </div>
    <div class="preview-frame" id="wrapPreview">
      <img id="editPreview" alt="Vista previa" />
    </div>
    <div id="msgEdit" class="muted-sm" style="margin-top:.5rem"></div>
    <div style="display:flex;gap:.5rem;justify-content:flex-end;margin-top:1rem">
      <button type="button" id="btnClose" class="btn">Cancelar</button>
      <button class="btn-primary">Guardar cambios</button>
    </div>
  </form>
</dialog>

<footer class="site-footer">
  <div class="container footer-grid">
    <p>© 2025 Ludus Stamps. Todos los derechos reservados.</p>
    <p><a class="link" href="#contacto">Contacto</a></p>
  </div>
</footer>

<script src="/js/auth-ui.js" defer></script>
<script src="/js/user-designs.js" defer></script>
<script>
  (function(){
    const here = location.pathname.replace(/\/+$/, "");
    document.querySelectorAll(".admin-subnav .tab").forEach(a => {
      const href = a.getAttribute("href").replace(/\/+$/, "");
      if (href === here) a.classList.add("active");
    });
  })();
</script>
</body>
</html>
