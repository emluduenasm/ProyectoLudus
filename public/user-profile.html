<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="utf-8"/>
  <meta name="viewport" content="width=device-width,initial-scale=1"/>
  <title>Mi perfil · Ludus Stamps</title>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css"/>
  <link rel="stylesheet" href="/styles.css"/>
  <style>
    .profile-wrap{max-width:960px;margin:2rem auto;padding:1rem}
    .profile-layout{display:grid;gap:1.5rem;grid-template-columns:2fr minmax(260px,1fr)}
    @media(max-width:960px){.profile-layout{grid-template-columns:1fr}}
    .profile-card{background:#fff;border-radius:14px;box-shadow:var(--shadow-sm,0 2px 10px rgba(2,6,23,.06));padding:1.5rem}
    .profile-grid{display:grid;gap:1rem 1.2rem;grid-template-columns:repeat(auto-fit,minmax(220px,1fr));margin-top:1rem}
    .profile-grid label{display:flex;flex-direction:column;font-size:.9rem;color:#475569}
    .profile-grid input, .profile-grid select{margin-top:.35rem}
    .profile-stats{display:flex;gap:1.5rem;margin-top:1.25rem}
    .profile-stats div{display:flex;flex-direction:column;gap:.1rem;color:#475569}
    .profile-stats strong{font-size:1.4rem;color:#0f172a}
    .avatar-box{display:flex;flex-direction:column;gap:1rem;align-items:flex-start}
    .avatar-preview{width:160px;aspect-ratio:1/1;border-radius:18px;overflow:hidden;background:#e2e8f0}
    .avatar-preview img{width:100%;height:100%;object-fit:cover;display:block}
    .msg{min-height:1.2em;font-size:.9rem;margin-top:.75rem;color:#64748b}
    .msg.ok{color:#0f766e}
    .msg.error{color:#b91c1c}
  </style>
</head>
<body>
  <header class="site-header">
    <div class="container nav">
      <a class="brand" href="/"><img src="/img/logo.png" alt="Logo"/></a>
      <nav class="menu">
        <a href="/"><i class="fa-solid fa-house"></i> Inicio</a>
        <a href="/designs.html"><i class="fa-solid fa-palette"></i> Diseños</a>
      </nav>
    </div>
  </header>

  <main class="profile-wrap">
    <h1>Mi perfil</h1>

    <nav class="admin-subnav" style="margin-bottom:1rem">
      <a href="/user-designs.html" class="tab"><i class="fa-solid fa-rectangle-list"></i> Mis diseños</a>
      <a href="/upload.html" class="tab"><i class="fa-solid fa-cloud-arrow-up"></i> Subir diseño</a>
      <a href="/user-profile.html" class="tab"><i class="fa-solid fa-user-gear"></i> Mi perfil</a>
    </nav>

    <div class="profile-layout">
      <section class="profile-card">
        <h2 style="margin:0">Datos personales</h2>
        <p class="muted" style="margin-top:.35rem">Actualizá tu información y cómo querés que te vean en la plataforma.</p>

        <form id="formProfile" class="profile-grid" novalidate>
          <label>Alias / Usuario
            <input class="input" type="text" name="username" required minlength="3" maxlength="32" />
            <span class="hint">Letras, números, punto o guion bajo.</span>
          </label>
          <label>Email
            <input class="input" type="email" name="email" readonly />
          </label>
          <label>Nombres
            <input class="input" type="text" name="first_name" required minlength="2" />
          </label>
          <label>Apellidos
            <input class="input" type="text" name="last_name" required minlength="2" />
          </label>
          <label>DNI
            <input class="input" type="text" name="dni" inputmode="numeric" maxlength="8" required />
          </label>
        </form>

        <div class="profile-stats">
          <div>
            <strong id="statDesigns">0</strong>
            <span class="muted-sm">Diseños publicados</span>
          </div>
          <div>
            <strong id="statLikes">0</strong>
            <span class="muted-sm">Likes acumulados</span>
          </div>
        </div>

        <div class="form-actions" style="margin-top:1.5rem">
          <button type="submit" form="formProfile" class="btn btn-primary">Guardar cambios</button>
          <span id="msgProfile" class="msg"></span>
        </div>
      </section>

      <section class="profile-card">
        <h2 style="margin:0">Imagen de perfil</h2>
        <p class="muted" style="margin-top:.35rem">Usá un logo cuadrado o tu foto para que te reconozcan.</p>

        <div class="avatar-box">
          <div class="avatar-preview">
            <img id="avatarPreview" alt="Avatar del diseñador" src="/img/disenador1.jpg"/>
          </div>
          <form id="formAvatar" style="width:100%" novalidate>
            <label class="input" style="padding:.4rem .75rem;display:block">
              <input type="file" id="avatarFile" name="avatar" accept="image/png,image/jpeg,image/webp" style="border:0;width:100%;padding:0"/>
            </label>
            <div class="hint">PNG, JPG o WEBP hasta 4 MB. Se ajustará automáticamente.</div>
            <div class="form-actions" style="margin-top:1rem;justify-content:flex-start">
              <button class="btn btn-primary" type="submit">Actualizar imagen</button>
              <span id="msgAvatar" class="msg"></span>
            </div>
          </form>
        </div>
      </section>
    </div>
  </main>

  <footer class="site-footer">
    <div class="container footer-grid">
      <p>© 2025 Ludus Stamps. Todos los derechos reservados.</p>
      <p><a class="link" href="#contacto">Contacto</a></p>
    </div>
  </footer>

  <script src="/js/auth-ui.js" defer></script>
  <script src="/js/user-profile.js" defer></script>
  <script>
    (function(){
      const here = location.pathname.replace(/\/+$/, "");
      document.querySelectorAll(".admin-subnav .tab").forEach(a => {
        const href = a.getAttribute("href").replace(/\/+$/, "");
        if (href === here) a.classList.add("active");
      });
    })();
  </script>
</body>
</html>
